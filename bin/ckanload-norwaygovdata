#!/usr/bin/env python

from ckanclient.loaders.base import SimpleGoogleSpreadsheetLoader 

class NorwegianGovernmentLoader(SimpleGoogleSpreadsheetLoader):
    """
    Obtains packages from Norwegian Government spreadsheet and puts them on CKAN.
    """
    
    HEADING_ROW_POSN = 2
    FIRST_ENTITY_ROW_POSN = 3

    def entity_to_package(self, entity):
        """Makes a CKAN package from Norwegian Government spreadsheet entity."""
        if entity.get('Unique identifier', ''):
            package = self.create_package(
                name=entity.pop('Unique identifier'),
                title=entity.pop('Title (description)', ''),
                url=entity.pop('Url to source of data', ''),
                maintainer=entity.pop('Updated by', ''),
                author=entity.pop('Updated by', ''),
                notes=entity.pop('notes', ''),
                tags=['norwegian-government-data'],
                extras=entity,
            )
        else:
            package = None
        return package

if __name__ == '__main__':
    NorwegianGovernmentLoader().run()

